# Crypto challenges

This folder contains the write-ups of the challenges we solved in HSCTF in the crypto category

### XORed
_**Challenge**_ 
```
  I was given the following equations. Can you help me decode the flag?

  Key 1 = 5dcec311ab1a88ff66b69ef46d4aba1aee814fe00a4342055c146533
  Key 1 ^ Key 3 = 9a13ea39f27a12000e083a860f1bd26e4a126e68965cc48bee3fa11b
  Key 2 ^ Key 3 ^ Key 5 = 557ce6335808f3b812ce31c7230ddea9fb32bbaeaf8f0d4a540b4f05
  Key 1 ^ Key 4 ^ Key 5 = 7b33428eb14e4b54f2f4a3acaeab1c2733e4ab6bebc68436177128eb
  Key 3 ^ Key 4 = 996e59a867c171397fc8342b5f9a61d90bda51403ff6326303cb865a
  Flag ^ Key 1 ^ Key 2 ^ Key 3 ^ Key 4 ^ Key 5 = 306d34c5b6dda0f53c7a0f5a2ce4596cfea5ecb676169dd7d5931139
```

_**Solution**_
  ```md
  Key1 ^ Key4 = (Key1 ^ Key3) ^ (Key3 ^ Key4)
  Flag = (Key1 ^ Key4) ^ (Key2 ^ Key3 ^ Key5) ^ (Flag ^ Key1 ^ Key2 ^ Key3 ^ Key4 ^ Key5)
       = 666c61677b6e30745f7430305f683472445f6830703366756c6c797d
  ```
  Thus the flag is : **flag{n0t_t00_h4rD_h0p3fully}**
  
### Unexpected

_**Challenge**_

<img src = "https://github.com/meenakshisl/CTF-Write-ups/blob/master/HSCTF2020/Crypto/Unexpected.png" width="400"     height="400" />

_**Solution**_

   The public keys when taken pairwise share a common factor hence taking the GCD pairwise will give us the private key     values. Now we can easily recover the flag.

### Chonky E

_**Challenge**_
```md
Allen and Jason rely on two different cryptosystems to keep their information secure.

Allen uses the RSA cryptosystem, given by the following public key: e = 91043118409828550796773745518585981151180206101005135117565865602978722878478494447048783557571813980525643725323377488249838860897784683927029906188947001149632101513367258267329961684034661252866484981926055087386190015432964608927947646476193251820354738640453947833718397360834701566765504916472450194494897616371452996381159817427887623703639133290358520498419049175941584678802701606995099241245926884172985004839801270005583030514286561971825047719421487004569752638468907609110285739083279629747310953086535889932550905065172805818862336335628248528993024112446002398466115161473573451161053837400091893285717 n = 156749047558583013960513267351769479915110440411448078412590565797031533622509813352093119636835511977253033854388466854142753776146092587825440445182008237325262012698034419137157047927918635897378973846177552961727126115560551970797370239385129543828686170774323306933202481728884019420422360360849592983818405154473369790181636472137741865440233383956571081122982223602667853668754338360008279002325576495573847568301584365514417593244726435632222027817410359417329310347952169273512510934251453361933794586716533950489973436393834189505450956622286216819440777162804798432330933357058175885674184582816364542591313

Jason uses the Schmidt-Samoa cryptosystem. Although a public key has not been recovered, we know that Allen and Jason share the same primes (p,q).

A ciphertext was found on Jasonâ€™s computer that reads: 16267540901004879123859424672087486188548628828063789528428674467464407443871599865993337555869530486241139138650641838377419734897801380883629894166353225288006148210453677023750688175192317241440457768788267270422857060534261674538755743244831152470995124962736526978165448560149498403762447372653982922113772190234143253450918953235222315161964539311032659628670417496174123483045439359846360048774164337257829398345686635091862306204455687347443958931441225500856408331795261329035072585605404416473987280037959184981453888701567175803979981461050532113072292714696752692872526424122826696681194705563391161137426703690900733706866842363055967856443765215723398555522126909749236759332964873221973970368877565410624895160438695006432021529071866881905134494489266801004903504121740435965696128048690741210812963902631391765192187570107372453917327060678806282122942318369245760773848604249664378721970318257356486696764545

What are the contents of this message?
```

_**Solution**_

e is very large in Allen's public key. Thus p and q can be recovered using [wiener's attack](https://github.com/pwang00/Cryptographic-Attacks/blob/master/Public%20Key/RSA/wiener.sage) whose implementation can be found online. We thus get p and q.

Jason uses [the Schmidt-Samoa cryptosystem](https://en.wikipedia.org/wiki/Schmidt-Samoa_cryptosystem)

```python
N = p**2 * q
```
Since LCM = (p * q )/ GCD(p,q)

```python
from Crypto.Util.number import GCD, long_to_bytes
lcm = (p * q ) //GCD(p,q)
d = inverse(N,lcm)
m = pow(c,d,p*q)
print(long_to_bytes(m))
```
We get the flag as: **flag{remarkably_superb_acronym}**
###
